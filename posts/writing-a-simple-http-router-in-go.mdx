---
title: "Writing a simple HTTP router from scratch in Go"
date: 2023-07-02
description: "Building a minimal HTTP router to understand how frameworks like Chi and Gin work under the hood."
---

The best way to understand a framework is to build a toy version. Here's a minimal HTTP router in Go.

## The core idea

An HTTP router maps method + path pairs to handler functions. At its simplest, it's a map lookup with some pattern matching.

```go
type Router struct {
  routes map[string]http.HandlerFunc
}

func (r *Router) Handle(method, path string, handler http.HandlerFunc) {
  key := method + " " + path
  r.routes[key] = handler
}

func (r *Router) ServeHTTP(w http.ResponseWriter, req *http.Request) {
  key := req.Method + " " + req.URL.Path
  if handler, ok := r.routes[key]; ok {
    handler(w, req)
    return
  }
  http.NotFound(w, req)
}
```

## Adding path parameters

The tricky part is supporting patterns like `/users/:id`. You need to split the path into segments and match against registered patterns, extracting named parameters along the way.

This is where real routers like Chi use a radix tree for performance. Our naive approach iterates all routes, which is fine for learning but O(n) per request.

## What I learned

Building this taught me more about Go's `http` package than any tutorial. The `Handler` interface — just one method, `ServeHTTP` — is one of the best API designs in any standard library.
