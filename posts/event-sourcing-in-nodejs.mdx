---
title: "Event sourcing in Node.js: lessons from production"
date: 2023-09-18
description: "What worked, what didn't, and what I'd do differently with event sourcing."
---

We adopted event sourcing for our order processing system. Two years in, here's my honest assessment.

## What worked

The audit trail is incredible. Every state change is an event, so we can reconstruct the exact state of any order at any point in time. This saved us during a billing dispute that would have been impossible to resolve with traditional CRUD.

## What didn't work

Event versioning is painful. When your event schema changes — and it will — you need a strategy for handling old events. We went with upcasting, which works but adds complexity to every schema change.

```typescript
// Every event schema change requires an upcaster
const upcasters = {
  'OrderPlaced_v1': (event) => ({
    ...event,
    version: 2,
    currency: event.currency || 'EUR', // added in v2
  })
}
```

## Would I do it again?

For audit-heavy domains like payments and compliance, absolutely. For a CRUD app? Just use PostgreSQL and save yourself the complexity. Event sourcing is a powerful pattern applied to the right problem, and an expensive mistake applied to the wrong one.
